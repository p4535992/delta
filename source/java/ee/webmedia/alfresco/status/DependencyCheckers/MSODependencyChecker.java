package ee.webmedia.alfresco.status.DependencyCheckers;

import java.io.*;
import java.net.*;
import javax.activation.DataSource; 
import javax.mail.internet.MimeMultipart;
import java.util.List; 


/**
 * 
 * @author viljar.tina
 *
 */
public class MSODependencyChecker extends DependencyChecker{

	
	/**
	 * 
	 */
	public MSODependencyChecker( String name, String uri, Boolean isFatal ) {
		super(name, uri, isFatal);
	}
	
	
	
	/**
	 * 
	 */
	public Boolean Test ( ) {
		try{
			URL url = new URL(this.Uri);
			HttpURLConnection conn = (HttpURLConnection) url.openConnection();
			conn.setDoOutput( true );
			conn.setDoInput(true);
			conn.setInstanceFollowRedirects( false );
			conn.setRequestMethod("POST");
			conn.setRequestProperty( "Content-Type", "text/xml;charset=UTF-8"); 
			conn.setRequestProperty( "SOAPAction", "http://webmedia.ee/mso/MsoPortBinding/convertToPdf");

			conn.setUseCaches( false );
			
			
			StringBuilder postData = new StringBuilder();
			postData.append(
"<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:mso=\"http://webmedia.ee/mso\">\r\n"
+ "   <soapenv:Header/>\r\n"
+ "   <soapenv:Body>\r\n"
+ "      <mso:msoDocumentInput>\r\n"
+ "<mso:documentFile>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</mso:documentFile>\r\n"
+ "		<mso:fileType>application/vnd.openxmlformats-officedocument.wordprocessingml.document</mso:fileType>\r\n"
+ "</mso:msoDocumentInput>\r\n"
+ "</soapenv:Body>\r\n"
+ "</soapenv:Envelope>");

			//Send request ..
			conn.getOutputStream().write(postData.toString().getBytes("UTF-8"));

			
			// Get response ..
			Integer statusCode = conn.getResponseCode(); 
			String statusMesg = conn.getResponseMessage();
			Status = STATUS_NOK;
			if(statusCode.equals(200)){
				
				
				// TODO: pmts võiks ka tsekata, kas vastuse manusena ikkagi ka pdf tagasi saadetakse.
				//String ctype = conn.getHeaderField("Content-Type");            
				//MimeMultipart  mp = new MimeMultipart(new InputStreamDataSource(conn.getInputStream(), ctype));
				
				
				Status = STATUS_OK;
			    return true;
			}
									
			// ..
			StatusMsg = statusCode + " " + statusMesg;	
			
		    return false;
		}catch(Exception ex){
			StatusMsg = ex.getMessage();
			
			Status = STATUS_NOK;
		    return false;
		}
		
	}
		
		private class InputStreamDataSource implements DataSource { 
			 
		    protected final InputStream in; 
		 
		    protected final String ctype; 
		 
		    protected final String name; 
		 
		    public InputStreamDataSource(InputStream in, String ctype) { 
		        this(in, ctype, "MultipartRequest"); 
		    } 
		 
		    public InputStreamDataSource(InputStream in, String ctype, String name) { 
		        this.in = in; 
		        this.name = name; 
		        this.ctype = ctype; 
		    } 
		 
		    public OutputStream getOutputStream() throws IOException { 
		        throw new UnsupportedOperationException("data source is not writeable"); 
		    } 
		 
		    public String getName() { 
		        return name; 
		    } 
		 
		    public InputStream getInputStream() throws IOException { 
		        return in; 
		    } 
		 
		    public String getContentType() { 
		        return ctype; 
		    } 
		
		
		
    }

	
}